<div *ngIf="isLoading" class="text-center">
  <div class="spinner-border text-primary" role="status">
    <span class="visually-hidden">Chargement...</span>
  </div>
</div>

<div *ngIf="error" class="alert alert-danger text-center">
  {{ error }}
</div>

<div *ngIf="event" class="container">
  <div class="card shadow-sm">
    <div class="card-header bg-dark bg-gradient">
      <h1 class="card-title text-primary">{{ event.title }}</h1>
    </div>
    <div class="card-body px-0 pb-0">
      <p class="mx-2 my-3">
        <strong>Description :</strong> {{ event.description }}
      </p>
      <hr />
      <p class="mx-2">
        <strong>Date :</strong> {{ event.date | date: "fullDate" }}
      </p>
      <p class="mx-2"><strong>Lieu :</strong> {{ event.location }}</p>
      <p class="mx-2">
        <strong>Nombre max de participants :</strong>
        {{ event.maxParticipants }}
      </p>
      <p class="mx-2"><strong>Type de sport :</strong> {{ event.sportType }}</p>

      <div *ngIf="event?.participants" class="list-group col-12 mt-2">
        <hr />
        <h4>Listes des participants ({{ event?.participants.length }})</h4>
        @if (event?.participants.length === 0) {
          <p class="alert-info alert">Pas de participants</p>
        }
        @for (item of event?.participants; track item._id) {
          <a
            class="list-group-item list-group-item-action list-group-item-primary"
            [routerLink]="['/dashboard/user/', item._id]"
          >
            {{ item.name + " " + item.lastName + " - " + item.mail }}
          </a>
        }
      </div>

      <app-registration-form
        [eventId]="eventId"
        [userId]="userId"
        [isRegister]="isResgister"
        *ngIf="
          role === 'sportif' &&
          event.maxParticipants > event.participants.length
        "
      ></app-registration-form>

      <div
        *ngIf="event.organizer"
        class="bg-dark bg-gradient card-footer d-flex flex-column flex-md-row justify-content-center gap-3"
      >
        <p class="text-primary">Organisateur</p>
        <p class="p-0 text-light">
          {{ event.organizer.name + " " + event.organizer.lastName }}
        </p>
        <p>
          <a href="mailto:{{ event.organizer.mail }}">{{
            event.organizer.mail
          }}</a>
        </p>
      </div>
    </div>
  </div>
</div>
